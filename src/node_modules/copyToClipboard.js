const bel = require('bel')
var csjs = require('csjs-inject')
const notification = require('notification')
const copy = require('copy-text-to-clipboard')
const icon = require('icon')
const svg = require('./svg.json')

module.exports = copyToClipboard

function copyToClipboard (hash) {
  const copyIcon = bel`
    <span class="${css['icon-duplicate']}" title="Copy address">
      ${icon('duplicate', svg.duplicate)}
    </span>`
  const message = "Contract address successfully copied"
  copyIcon.onclick = (event) => {
    event.stopPropagation()
    try {
      var copiableContent = hash
    } catch (e) {
      return notification({ type: 'error', body: 'copy failed: ' + e.message})
    }
    if (copiableContent) {
      copy(copiableContent)
      notification(message)
    }
  }
  return copyIcon
}
const css = csjs`
.icon-duplicate {
  cursor: pointer;
  position: absolute;
  right: 5px;
  bottom: -8px;
  width: 22px;
}
.icon-duplicate svg g {
  fill: var(--card-icon-fill);
}`
