const parser = document.createElement('div')
const script = document.createElement('script')
script.setAttribute('src', 'https://cdn.jsdelivr.net/npm/jdenticon@2.2.0')
document.head.appendChild(script)
var jdenticon
script.onload = () => {
  jdenticon = window.jdenticon
  delete window.jdenticon
}

module.exports = avatarGenerator

function avatarGenerator (data = 'hello world', size = 80) {
  parser.innerHTML = `<svg width="${size}" height="${size}" data-jdenticon-value="${data}"></svg>`
  const icon = parser.children[0]
  parser.innerHTML = ''
  if (jdenticon) jdenticon.update(icon, data + Math.random())
  return icon
}
